<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>Appel d&#39;une API ProSantéConnectée avec des données métiers complémentaires - Sécurisation de la couche transport API REST v1.1.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <link rel="stylesheet" href="assets/css/style-ans.css"/>
    <link rel="stylesheet" href="assets/css/style-add-ans.css"/>
    <!-- Placeholder for child template CSS declarations -->

    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"3.5"}
    h3,h4,h5,h6{--heading-prefix:"3.5"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->
<div id="family-nav">
  <a id="hl7-search-lnk" no-external="true" href="http://hl7.org/fhir"><img height="50" alt="Visit the FHIR website" src="assets/images/fhir-logo-www.png"/> </a>
</div>
<div id="ans-nav" style="line-height: 50px; float: left; margin-top: 4px; margin-bottom: 8px; color: #808080; ">
  <a id="hl7-logo" no-external="true" href="https://esante.gouv.fr/"><img height="50" alt="ANS Logo" src="assets/images/logo-ANS.svg"/></a>
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Sécurisation de la couche transport API REST</span>
            <br/>
            <span style="display:inline-block;">1.1.0 - ci-build


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">Accueil</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Description générale des flux
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="principes_generaux_du_volet.html">Principes généraux de ce volet</a>
      </li>
      <li>
        <a href="archi_documentaire.html">Architecture documentaire</a>
      </li>
      <li>
        <a href="standards.html">Standards utilisés (REST, OAUTH 2.0 ET OIDC)</a>
      </li>
      <li>
        <a href="principes_securisation.html">Principes de sécurisation</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">API ProSantéConnectée
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="api_prosanteconnectee.html">Description générale</a>
      </li>
      <li>
        <a href="api_prosanteconnectee_web.html">Application web</a>
      </li>
      <li>
        <a href="api_prosanteconnectee_web_erreurs.html">Application web - cas d&apos;erreurs</a>
      </li>
      <li>
        <a href="api_prosanteconnectee_client_lourd.html">Application client lourd ou mobile</a>
      </li>
      <li>
        <a href="api_prosanteconnectee_userinfo.html">Récupération et utilisation du jeton userinfo PSC</a>
      </li>
      <li>
        <a href="api_prosanteconnectee_donnees_metiers.html">Passage de données métiers de l&apos;application cliente vers l&apos;API</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Glossaire et documents de référence
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="glossaire.html">Glossaire</a>
      </li>
      <li>
        <a href="documents_de_reference.html">Documents de référence</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="about.html">A propos de ce guide</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><a href='api_prosanteconnectee.html'><b>API ProSantéConnectée</b></a></li><li><b>Appel d'une API ProSantéConnectée avec des données métiers complémentaires</b></li>

          <span style="float:right;">

            <a href="api_prosanteconnectee_userinfo.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="glossaire.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">Sécurisation de la couche transport API REST - Local Development build (v1.1.0). See the <a href="https://interop.esante.gouv.fr/ig/securisation-transport/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>Appel d&#39;une API ProSantéConnectée avec des données métiers complémentaires</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#services-cibles-existants-utilisant-une-assertion-saml" id="markdown-toc-services-cibles-existants-utilisant-une-assertion-saml">Services cibles existants utilisant une assertion SAML</a></li>
  <li><a href="#nouveaux-services-cibles-ce-paragraphe-est-en-cours-de-rédaction" id="markdown-toc-nouveaux-services-cibles-ce-paragraphe-est-en-cours-de-rédaction">Nouveaux Services cibles (ce paragraphe est en cours de rédaction)</a></li>
</ul>

</div>
<p><strong>Certains services cibles Pro Santé Connectés nécessitent l’envoi de données métiers complémentaires concernant le LPS, le proxy API ou l’activité du PS.</strong></p>

<ul>
  <li>Des services existants historiques assurent ce besoin grâce à <strong>une assertion SAML</strong> appelée <strong>VIHF</strong> et souhaitent minimiser l’impact de l’intégration du protocole <code class="language-plaintext highlighter-rouge">OAuth 2.0</code>.</li>
  <li>Pour les autres services souhaitant répondre à ce besoin, ils devront à terme utiliser le paramètre <code class="language-plaintext highlighter-rouge">actor_token</code> spécifié dans le protocole <code class="language-plaintext highlighter-rouge">OAuth 2.0</code>.</li>
</ul>

<h3 id="services-cibles-existants-utilisant-une-assertion-saml">Services cibles existants utilisant une assertion SAML</h3>

<p><strong>Pour les services historiques utilisant l’assertion SAML et qui voudraient minimiser les impacts côté client éditeurs, il est possible de créer une architecture de transition qui utlise l’assertion SAML pour transmette les données métier.</strong></p>

<ul>
  <li>Le schéma ci-dessous présente l’intégration du requêtage par protocole SOAP dans un flux OAuth 2.0</li>
  <li>Les flux 13 et 14 représentent l’accès à l’API avec la requête SOAP et l’assertion SAML. 
Le Client lourd LPS crée et peuple l’assertion SAML et génère la requête SOAP. Il est préconisé d’utiliser une connexion mTLS lors du flux 14.</li>
</ul>

<p><strong>Pour plus précisions pour plus de précisions concernant le flux 13 se référer au document CI-SIS volet transport synchrone Client Lourd et au document CI AMO volet transport synchrone pour les services de l’Assurance Maladie [1]</strong>.</p>

<ul>
  <li>Le flux 17 représente l’accès au service cible avec <strong>la requête SOAP et l’assertion SAML</strong> avec l’<code class="language-plaintext highlighter-rouge">access_token</code> de l’API passé à l’en-tête <code class="language-plaintext highlighter-rouge">Authorization : Bearer</code> de la requête.</li>
</ul>

<div style="text-align: center;"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="637.891px" preserveAspectRatio="none" style="width:1024px;height:637px;background:#FFFFFF;" version="1.1" viewBox="0 0 1024 637" width="1024.6489px" zoomAndPan="magnify"><defs /><g><rect fill="#98FB98" height="630.2205" style="stroke:#181818;stroke-width:0.3244613434727503;" width="484.4208" x="10.3828" y="3.8935" /><text fill="#000000" font-family="sans-serif" font-size="8.436" font-weight="bold" lengthAdjust="spacing" textLength="139.5184" x="182.834" y="11.724">Systeme appelant / initiateur</text><rect fill="#AFEEEE" height="630.2205" style="stroke:#181818;stroke-width:0.3244613434727503;" width="273.8454" x="746.91" y="3.8935" /><text fill="#000000" font-family="sans-serif" font-size="8.436" font-weight="bold" lengthAdjust="spacing" textLength="66.839" x="850.4132" y="11.724">Systeme cible</text><rect fill="#FFFFFF" height="38.3726" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="48.0203" y="75.7262" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="56.8213" /><rect fill="#FFFFFF" height="92.4056" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="400.2687" /><rect fill="#FFFFFF" height="23.4474" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="576.73" /><rect fill="#FFFFFF" height="325.1052" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="316.6743" y="94.6312" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="422.4487" y="186.474" /><rect fill="#FFFFFF" height="228.1572" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="641.7845" y="148.6641" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="641.7845" y="511.5792" /><rect fill="#FFFFFF" height="103.5234" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="799.4728" y="473.2066" /><rect fill="none" height="181.2624" style="stroke:#000000;stroke-width:0.9733840304182508;" width="414.9861" x="280.6591" y="123.8327" /><rect fill="none" height="67.8327" style="stroke:#000000;stroke-width:0.9733840304182508;" width="689.1559" x="6.4892" y="314.18" /><rect fill="none" height="152.4512" style="stroke:#000000;stroke-width:0.9733840304182508;" width="979.2243" x="6.4892" y="429.4702" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="51.2649" x2="51.2649" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="233.9366" x2="233.9366" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="319.5944" x2="319.5944" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="425.3688" x2="425.3688" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="645.0292" x2="645.0292" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="802.7174" x2="802.7174" y1="36.6185" y2="611.858" /><line style="stroke:#181818;stroke-width:0.3244613434727503;stroke-dasharray:5.0,5.0;" x1="985.7136" x2="985.7136" y1="36.6185" y2="611.858" /><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="76.5729" x="12.9785" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="67.488" x="17.5209" y="29.2845">Client Lourd PS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="76.5729" x="12.9785" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="67.488" x="17.5209" y="624.1844">Client Lourd PS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="68.1369" x="200.1926" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="59.052" x="204.7351" y="29.2845">Proxy LPS API</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="68.1369" x="200.1926" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="59.052" x="204.7351" y="624.1844">Proxy LPS API</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="65.5412" x="287.1483" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="56.4563" x="291.6907" y="29.2845">Proxy LPS FS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="65.5412" x="287.1483" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="56.4563" x="291.6907" y="624.1844">Proxy LPS FS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="133.0292" x="359.1787" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="123.9442" x="363.7212" y="29.2845">Device d'authentification PS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="133.0292" x="359.1787" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="123.9442" x="363.7212" y="624.1844">Device d'authentification PS</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="88.2535" x="600.9024" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="79.1686" x="605.4449" y="29.2845">ProSanteConnect</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="88.2535" x="600.9024" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="79.1686" x="605.4449" y="624.1844">ProSanteConnect</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="106.4233" x="749.5057" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="97.3384" x="754.0482" y="29.2845">Serveur d'autorisation</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="106.4233" x="749.5057" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="97.3384" x="754.0482" y="624.1844">Serveur d'autorisation</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="64.8923" x="953.2674" y="16.3093" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="55.8074" x="957.8099" y="29.2845">Service cible</text><rect fill="#E2E2F0" height="19.6603" rx="1.6223" ry="1.6223" style="stroke:#181818;stroke-width:0.3244613434727503;" width="64.8923" x="953.2674" y="611.2091" /><text fill="#000000" font-family="sans-serif" font-size="9.0849" lengthAdjust="spacing" textLength="55.8074" x="957.8099" y="624.1844">Service cible</text><rect fill="#FFFFFF" height="38.3726" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="48.0203" y="75.7262" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="56.8213" /><rect fill="#FFFFFF" height="92.4056" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="400.2687" /><rect fill="#FFFFFF" height="23.4474" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="231.0165" y="576.73" /><rect fill="#FFFFFF" height="325.1052" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="316.6743" y="94.6312" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="422.4487" y="186.474" /><rect fill="#FFFFFF" height="228.1572" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="641.7845" y="148.6641" /><rect fill="#FFFFFF" height="18.9049" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="641.7845" y="511.5792" /><rect fill="#FFFFFF" height="103.5234" style="stroke:#181818;stroke-width:0.6489226869455006;" width="6.4892" x="799.4728" y="473.2066" /><polygon fill="#181818" points="223.2294,54.2256,229.7186,56.8213,223.2294,59.417,225.8251,56.8213" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="51.2649" x2="227.1229" y1="56.8213" y2="56.8213" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="61.6477" x="55.8074" y="53.5339">1 : initialisation</text><polygon fill="#181818" points="61.6477,73.1305,55.1584,75.7262,61.6477,78.3219,59.052,75.7262" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="57.7541" x2="233.6122" y1="75.7262" y2="75.7262" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="121.3485" x="65.5412" y="72.4388">2 : partage du jeton applicatif</text><polygon fill="#181818" points="308.8872,92.0355,315.3764,94.6312,308.8872,97.2269,311.4829,94.6312" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="54.5095" x2="312.7807" y1="94.6312" y2="94.6312" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="60.9987" x="59.052" y="91.3438">3 : acces initial</text><path d="M280.6591,123.8327 L411.0925,123.8327 L411.0925,128.4613 L404.6033,134.9506 L280.6591,134.9506 L280.6591,123.8327 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.9733840304182508;" /><rect fill="none" height="181.2624" style="stroke:#000000;stroke-width:0.9733840304182508;" width="414.9861" x="280.6591" y="123.8327" /><text fill="#000000" font-family="sans-serif" font-size="8.436" font-weight="bold" lengthAdjust="spacing" textLength="101.2319" x="290.3929" y="132.3121">Authentification CIBA</text><polygon fill="#181818" points="633.9975,146.0684,640.4867,148.6641,633.9975,151.2598,636.5932,148.6641" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="323.1635" x2="637.891" y1="148.6641" y2="148.6641" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="44.7757" x="327.706" y="145.3767">4 : redirect</text><polygon fill="#181818" points="330.3016,164.9734,323.8124,167.5691,330.3016,170.1648,327.706,167.5691" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="326.4081" x2="641.1356" y1="167.5691" y2="167.5691" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="121.3485" x="334.1952" y="164.2817">4a: authentification reconnue</text><polygon fill="#181818" points="436.076,183.8783,429.5868,186.474,436.076,189.0697,433.4804,186.474" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="432.1825" x2="641.1356" y1="186.474" y2="186.474" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="186.8897" x="439.9696" y="183.1866">5 : demande d'authentification de l'utilisateur</text><polygon fill="#181818" points="633.9975,202.7833,640.4867,205.379,633.9975,207.9747,636.5932,205.379" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="425.6933" x2="637.891" y1="205.379" y2="205.379" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="197.2725" x="430.2357" y="202.0916">6 : transmission du resultat de l'authentification</text><polygon fill="#181818" points="633.9975,221.6882,640.4867,224.2839,633.9975,226.8796,636.5932,224.2839" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="323.1635" x2="637.891" y1="224.2839" y2="224.2839" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="147.9544" x="327.706" y="220.9965">7a : interrogation du statut du jeton</text><polygon fill="#181818" points="330.3016,240.5932,323.8124,243.1888,330.3016,245.7845,327.706,243.1888" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="326.4081" x2="641.1356" y1="243.1888" y2="243.1888" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="104.4766" x="334.1952" y="239.9015">7b : reponse sur le statut</text><polygon fill="#181818" points="633.9975,259.4981,640.4867,262.0938,633.9975,264.6895,636.5932,262.0938" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="323.1635" x2="637.891" y1="262.0938" y2="262.0938" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="147.3054" x="327.706" y="258.8064">7c : interrogation du statut du jeton</text><polygon fill="#181818" points="330.3016,278.403,323.8124,280.9987,330.3016,283.5944,327.706,280.9987" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="326.4081" x2="641.1356" y1="280.9987" y2="280.9987" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="104.4766" x="334.1952" y="277.7113">7d : reponse sur le statut</text><polygon fill="#181818" points="330.3016,297.308,323.8124,299.9037,330.3016,302.4994,327.706,299.9037" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="326.4081" x2="641.1356" y1="299.9037" y2="299.9037" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="214.1445" x="334.1952" y="296.6163">8 : ID Token + Access Token + Refresh Token (PSC)</text><path d="M6.4892,314.18 L138.2205,314.18 L138.2205,318.8086 L131.7313,325.2978 L6.4892,325.2978 L6.4892,314.18 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.9733840304182508;" /><rect fill="none" height="67.8327" style="stroke:#000000;stroke-width:0.9733840304182508;" width="689.1559" x="6.4892" y="314.18" /><text fill="#000000" font-family="sans-serif" font-size="8.436" font-weight="bold" lengthAdjust="spacing" textLength="102.5298" x="16.2231" y="322.6594">userinfo - OPTIONNEL</text><polygon fill="#181818" points="633.9975,336.4157,640.4867,339.0114,633.9975,341.6071,636.5932,339.0114" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="323.1635" x2="637.891" y1="339.0114" y2="339.0114" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="68.1369" x="327.706" y="335.724">9. subject_token</text><polygon fill="#181818" points="330.3016,355.3207,323.8124,357.9163,330.3016,360.512,327.706,357.9163" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="326.4081" x2="641.1356" y1="357.9163" y2="357.9163" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="74.6261" x="334.1952" y="354.629">10. userinfo (PSC)</text><polygon fill="#181818" points="58.403,374.2256,51.9138,376.8213,58.403,379.417,55.8074,376.8213" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="54.5095" x2="316.0253" y1="376.8213" y2="376.8213" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="86.9556" x="62.2966" y="373.5339">11. OK/KO + userinfo</text><polygon fill="#181818" points="244.6439,397.673,238.1546,400.2687,244.6439,402.8644,242.0482,400.2687" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="240.7503" x2="316.0253" y1="400.2687" y2="400.2687" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="66.839" x="248.5374" y="396.9813">12 : Tokens PSC</text><path d="M6.4892,429.4702 L106.4233,429.4702 L106.4233,434.0989 L99.9341,440.5881 L6.4892,440.5881 L6.4892,429.4702 " fill="#EEEEEE" style="stroke:#000000;stroke-width:0.9733840304182508;" /><rect fill="none" height="152.4512" style="stroke:#000000;stroke-width:0.9733840304182508;" width="979.2243" x="6.4892" y="429.4702" /><text fill="#000000" font-family="sans-serif" font-size="8.436" font-weight="bold" lengthAdjust="spacing" textLength="70.7326" x="16.2231" y="437.9496">OAUTH2.0 flow</text><polygon fill="#181818" points="223.2294,451.706,229.7186,454.3016,223.2294,456.8973,225.8251,454.3016" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="51.2649" x2="227.1229" y1="454.3016" y2="454.3016" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="164.1774" x="55.8074" y="451.0143">13 : acces API + requete SOAP + SAML</text><polygon fill="#181818" points="791.6857,470.6109,798.1749,473.2066,791.6857,475.8023,794.2814,473.2066" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="237.5057" x2="795.5792" y1="473.2066" y2="473.2066" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="216.7402" x="242.0482" y="469.9192">14 :  subject_token(parametre) + scope(parametre)</text><polygon fill="#181818" points="655.4119,508.9835,648.9227,511.5792,655.4119,514.1749,652.8162,511.5792" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="651.5184" x2="798.8238" y1="511.5792" y2="511.5792" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="138.8695" x="659.3054" y="508.2918">15 : subject_token (introspection)</text><polygon fill="#181818" points="791.6857,527.8885,798.1749,530.4842,791.6857,533.0798,794.2814,530.4842" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="645.0292" x2="795.5792" y1="530.4842" y2="530.4842" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="11.6806" x="649.5716" y="527.1968">OK</text><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="805.962" x2="833.2167" y1="549.3891" y2="549.3891" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="833.2167" x2="833.2167" y1="549.3891" y2="557.8251" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="806.6109" x2="833.2167" y1="557.8251" y2="557.8251" /><polygon fill="#181818" points="813.1001,555.2294,806.6109,557.8251,813.1001,560.4208,810.5044,557.8251" style="stroke:#181818;stroke-width:0.6489226869455006;" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="167.4221" x="810.5044" y="546.1017">Controle d'acces (Client ID_AS x scopes)</text><polygon fill="#181818" points="244.6439,574.1343,238.1546,576.73,244.6439,579.3257,242.0482,576.73" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="240.7503" x2="802.0684" y1="576.73" y2="576.73" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="72.0304" x="248.5374" y="573.4426">16. access_token</text><polygon fill="#181818" points="977.9265,597.5817,984.4157,600.1774,977.9265,602.7731,980.5222,600.1774" style="stroke:#181818;stroke-width:0.6489226869455006;" /><line style="stroke:#181818;stroke-width:0.6489226869455006;" x1="234.2611" x2="981.82" y1="600.1774" y2="600.1774" /><text fill="#000000" font-family="sans-serif" font-size="8.436" lengthAdjust="spacing" textLength="166.7731" x="238.8035" y="596.8901">17 : access_token + acces aux donnees</text></g></svg></div>

<h3 id="nouveaux-services-cibles-ce-paragraphe-est-en-cours-de-rédaction">Nouveaux Services cibles (ce paragraphe est en cours de rédaction)</h3>

<p>L’ajout du paramètre actor_token [12] dans la requête token exchange permet de transmettre au serveur d’autorisation du service cible des données métiers complémentaires.</p>

<p><strong>L’actor_token_type doit alors y être spécifié conjointement</strong>.</p>

<p><strong>Certains services cibles historiques ont besoin des données suivantes :</strong></p>
<ul>
  <li>données identifiantes du LPS (lps_nom, lps_id, lps_version…),</li>
  <li>Situation d’exercice choisie par le PS sur son LPS.</li>
</ul>

<table width="652">
<tbody>
<tr>
<td width="132">
<p>Param&egrave;tres</p>
</td>
<td width="104">
<p>Obligatoire d&rsquo;apr&egrave;s la documentation officielle (OAuth 2.0)</p>
</td>
<td width="113">
<p>obligatoire pour le service cible</p>
</td>
<td width="302">
<p>Valeur</p>
</td>
</tr>
<tr>
<td width="132">
<p>grant_type</p>
</td>
<td width="104">
<p>Oui</p>
</td>
<td width="113">
<p>Oui</p>
</td>
<td width="302">
<p>urn:ietf:params:oauth:grant-type:token-exchange</p>
</td>
</tr>
<tr>
<td width="132">
<p>subject_token</p>
</td>
<td width="104">
<p>Oui</p>
</td>
<td width="113">
<p>Oui</p>
</td>
<td width="302">
<p>Access Token PSC</p>
</td>
</tr>
<tr>
<td width="132">
<p>subject_token_type</p>
</td>
<td width="104">
<p>Oui</p>
</td>
<td width="113">
<p>Oui</p>
</td>
<td width="302">
<p>urn:ietf:params:oauth:token-type:jwt</p>
</td>
</tr>
<tr>
<td width="132">
<p>actor_token</p>
</td>
<td width="104">
<p>Non</p>
</td>
<td width="113">
<p>Non</p>
</td>
<td width="302">
<p>JWT identifiant&nbsp;:</p>
<p>&Oslash; Proxy LPS API</p>
<p>&Oslash; Le LPS</p>
<p>&Oslash; L&rsquo;activit&eacute; du PS</p>
</td>
</tr>
<tr>
<td width="132">
<p>actor_token_type</p>
</td>
<td width="104">
<p>Non</p>
</td>
<td width="113">
<p>Non</p>
</td>
<td width="302">
<p>urn:ietf:params:oauth:token-type:jwt<br />
<b>ou bien</b><br />
urn:ietf:params:oauth:token-type:access_token</p>
</td>
</tr>
<tr>
<td width="132">
<p>scope</p>
</td>
<td width="104">
<p>Non</p>
</td>
<td width="113">
<p>Oui</p>
</td>
<td width="302">
<p>A d&eacute;terminer par les &eacute;quipes m&eacute;tiers</p>
<p>= scopes metier</p>
</td>
</tr>
</tbody>
</table>

<p><strong>Exemple de claims du JWT décodé correspondant à l’actor_token</strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"iss"</span><span class="p">:</span><span class="s2">"https://original-issuer.example.net"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1441910060</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sub"</span><span class="p">:</span><span class="w"> </span><span class="err">admin@example.net</span><span class="p">,</span><span class="w">
     </span><span class="nl">"lps_nom"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;lps_nom&gt;</span><span class="p">,</span><span class="w">
     </span><span class="nl">"lps_id"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;lps_id&gt;</span><span class="p">,</span><span class="w">
     </span><span class="nl">"lps_version"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;lps_version&gt;</span><span class="p">,</span><span class="w">
     </span><span class="s2">"situation_exercice”: &lt;situation_exercice &gt;
  }
</span></code></pre></div></div>
<ul>
  <li>
    <p>Selon les nécessités du service cible, l’<code class="language-plaintext highlighter-rouge">access_token</code> délivré peut être enrichi avec les claims de l’<code class="language-plaintext highlighter-rouge">actor_token</code> fournis lors de la requête.</p>
  </li>
  <li>
    <p>Le JWT <code class="language-plaintext highlighter-rouge">actor_token</code> dans le cas d’une <strong>API Pro Santé Connectée</strong> pourrait signé par la clé privée du certificat cachet serveur de la structure porteuse du fournisseur de services.         <br />
<strong>Cependant, le cas mTLS couvre ce besoin rendant la signature non nécessaire</strong>.</p>
  </li>
</ul>

<div style="text-align: center;"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="751.8294px" preserveAspectRatio="none" style="width:1024px;height:751px;background:#FFFFFF;" version="1.1" viewBox="0 0 1024 751" width="1024.84px" zoomAndPan="magnify"><defs /><g><rect fill="#98FB98" height="742.4053" style="stroke:#181818;stroke-width:0.4200164068908942;" width="284.3511" x="13.4405" y="5.0402" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" font-weight="bold" lengthAdjust="spacing" textLength="180.6071" x="65.3126" y="15.1768">Systeme appelant / initiateur</text><rect fill="#AFEEEE" height="742.4053" style="stroke:#181818;stroke-width:0.4200164068908942;" width="354.4938" x="665.306" y="5.0402" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" font-weight="bold" lengthAdjust="spacing" textLength="86.5234" x="799.2912" y="15.1768">Systeme cible</text><rect fill="#FFFFFF" height="143.3634" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="52.9221" y="73.5554" /><rect fill="#FFFFFF" height="74.146" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="52.9221" y="241.3913" /><rect fill="#FFFFFF" height="73.4176" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="73.5554" /><rect fill="#FFFFFF" height="248.8138" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="290.3363" /><rect fill="#FFFFFF" height="55.5537" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="647.9606" /><rect fill="#FFFFFF" height="74.146" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="191.7178" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="340.0098" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="415.1075" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="563.6226" /><rect fill="#FFFFFF" height="134.0115" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="733.3486" y="539.1501" /><rect fill="none" height="211.6292" style="stroke:#000000;stroke-width:1.2600492206726825;" width="593.9032" x="8.4003" y="159.5734" /><rect fill="none" height="87.8097" style="stroke:#000000;stroke-width:1.2600492206726825;" width="593.9032" x="8.4003" y="382.9631" /><rect fill="none" height="197.3486" style="stroke:#000000;stroke-width:1.2600492206726825;" width="966.0377" x="8.4003" y="482.5332" /><line style="stroke:#181818;stroke-width:0.4200164068908942;stroke-dasharray:5.0,5.0;" x1="57.1222" x2="57.1222" y1="47.4028" y2="718.6349" /><line style="stroke:#181818;stroke-width:0.4200164068908942;stroke-dasharray:5.0,5.0;" x1="249.9098" x2="249.9098" y1="47.4028" y2="718.6349" /><line style="stroke:#181818;stroke-width:0.4200164068908942;stroke-dasharray:5.0,5.0;" x1="536.781" x2="536.781" y1="47.4028" y2="718.6349" /><line style="stroke:#181818;stroke-width:0.4200164068908942;stroke-dasharray:5.0,5.0;" x1="737.5488" x2="737.5488" y1="47.4028" y2="718.6349" /><line style="stroke:#181818;stroke-width:0.4200164068908942;stroke-dasharray:5.0,5.0;" x1="974.4381" x2="974.4381" y1="47.4028" y2="718.6349" /><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="80.6432" x="16.8007" y="21.1124" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="68.8827" x="22.6809" y="37.9089">Client Lourd</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="80.6432" x="16.8007" y="717.7949" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="68.8827" x="22.6809" y="734.5915">Client Lourd</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="88.2034" x="206.2281" y="21.1124" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="76.443" x="212.1083" y="37.9089">Proxy LPS API</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="88.2034" x="206.2281" y="717.7949" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="76.443" x="212.1083" y="734.5915">Proxy LPS API</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="114.2445" x="479.6587" y="21.1124" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="102.484" x="485.539" y="37.9089">ProSanteConnect</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="114.2445" x="479.6587" y="717.7949" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="102.484" x="485.539" y="734.5915">ProSanteConnect</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="137.7654" x="668.6661" y="21.1124" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="126.0049" x="674.5463" y="37.9089">Serveur d'autorisation</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="137.7654" x="668.6661" y="717.7949" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="126.0049" x="674.5463" y="734.5915">Serveur d'autorisation</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="84.0033" x="932.4364" y="21.1124" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="72.2428" x="938.3167" y="37.9089">Service cible</text><rect fill="#E2E2F0" height="25.4504" rx="2.1001" ry="2.1001" style="stroke:#181818;stroke-width:0.4200164068908942;" width="84.0033" x="932.4364" y="717.7949" /><text fill="#000000" font-family="sans-serif" font-size="11.7605" lengthAdjust="spacing" textLength="72.2428" x="938.3167" y="734.5915">Service cible</text><rect fill="#FFFFFF" height="143.3634" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="52.9221" y="73.5554" /><rect fill="#FFFFFF" height="74.146" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="52.9221" y="241.3913" /><rect fill="#FFFFFF" height="73.4176" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="73.5554" /><rect fill="#FFFFFF" height="248.8138" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="290.3363" /><rect fill="#FFFFFF" height="55.5537" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="246.1296" y="647.9606" /><rect fill="#FFFFFF" height="74.146" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="191.7178" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="340.0098" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="415.1075" /><rect fill="#FFFFFF" height="24.4725" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="532.5808" y="563.6226" /><rect fill="#FFFFFF" height="134.0115" style="stroke:#181818;stroke-width:0.8400328137817884;" width="8.4003" x="733.3486" y="539.1501" /><polygon fill="#181818" points="236.0492,70.1952,244.4495,73.5554,236.0492,76.9155,239.4094,73.5554" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="61.3224" x2="241.0894" y1="73.5554" y2="73.5554" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="79.8031" x="67.2026" y="69.2998">1 : initialisation</text><polygon fill="#181818" points="70.5628,94.6678,62.1624,98.0279,70.5628,101.388,67.2026,98.0279" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="65.5226" x2="245.2896" y1="98.0279" y2="98.0279" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="157.0861" x="75.603" y="93.7724">2 : partage du jeton applicatif</text><polygon fill="#181818" points="236.0492,119.1403,244.4495,122.5004,236.0492,125.8605,239.4094,122.5004" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="61.3224" x2="241.0894" y1="122.5004" y2="122.5004" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="75.603" x="67.2026" y="118.2449">3. acces initial</text><polygon fill="#181818" points="70.5628,143.6128,62.1624,146.9729,70.5628,150.3331,67.2026,146.9729" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="65.5226" x2="249.4897" y1="146.9729" y2="146.9729" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="54.6021" x="75.603" y="142.7174">4. redirect</text><path d="M8.4003,159.5734 L263.7703,159.5734 L263.7703,165.5652 L255.37,173.9655 L8.4003,173.9655 L8.4003,159.5734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.2600492206726825;" /><rect fill="none" height="211.6292" style="stroke:#000000;stroke-width:1.2600492206726825;" width="593.9032" x="8.4003" y="159.5734" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" font-weight="bold" lengthAdjust="spacing" textLength="217.5685" x="21.0008" y="170.55">Authentification Pro Sante Connect</text><polygon fill="#181818" points="522.5004,188.3577,530.9007,191.7178,522.5004,195.0779,525.8605,191.7178" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="61.3224" x2="527.5406" y1="191.7178" y2="191.7178" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="144.4856" x="67.2026" y="187.4623">5. client_id, scope "all" PSC</text><polygon fill="#181818" points="70.5628,238.0312,62.1624,241.3913,70.5628,244.7514,67.2026,241.3913" style="stroke:#181818;stroke-width:0.8400328137817884;" /><polygon fill="#181818" points="522.5004,238.0312,530.9007,241.3913,522.5004,244.7514,525.8605,241.3913" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="65.5226" x2="527.5406" y1="241.3913" y2="241.3913" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="189.0074" x="75.603" y="237.1358">6. authentification user (CPS/eCPS)</text><polygon fill="#181818" points="70.5628,262.5037,62.1624,265.8638,70.5628,269.224,67.2026,265.8638" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="65.5226" x2="535.9409" y1="265.8638" y2="265.8638" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="138.6054" x="75.603" y="261.6083">7. authorization code PSC</text><polygon fill="#181818" points="236.0492,286.9762,244.4495,290.3363,236.0492,293.6965,239.4094,290.3363" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="61.3224" x2="241.0894" y1="290.3363" y2="290.3363" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="138.6054" x="67.2026" y="286.0808">8. authorization code PSC</text><polygon fill="#181818" points="522.5004,336.6497,530.9007,340.0098,522.5004,343.37,525.8605,340.0098" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="254.5299" x2="527.5406" y1="340.0098" y2="340.0098" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="151.2059" x="260.4102" y="335.7543">8. authorization code PSC +</text><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="100.8039" x="421.6965" y="335.7543">Client ID_FS/secret</text><polygon fill="#181818" points="263.7703,361.1222,255.37,364.4824,263.7703,367.8425,260.4102,364.4824" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="258.7301" x2="535.9409" y1="364.4824" y2="364.4824" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="214.2084" x="268.8105" y="360.2268">9. ID Token + AT + Refresh Token (PSC)</text><path d="M8.4003,382.9631 L178.927,382.9631 L178.927,388.9549 L170.5267,397.3552 L8.4003,397.3552 L8.4003,382.9631 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.2600492206726825;" /><rect fill="none" height="87.8097" style="stroke:#000000;stroke-width:1.2600492206726825;" width="593.9032" x="8.4003" y="382.9631" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" font-weight="bold" lengthAdjust="spacing" textLength="132.7252" x="21.0008" y="393.9397">userinfo - OPTIONNEL</text><polygon fill="#181818" points="522.5004,411.7473,530.9007,415.1075,522.5004,418.4676,525.8605,415.1075" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="254.5299" x2="527.5406" y1="415.1075" y2="415.1075" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="94.9237" x="260.4102" y="410.8519">10. subject_token</text><polygon fill="#181818" points="263.7703,436.2199,255.37,439.58,263.7703,442.9401,260.4102,439.58" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="258.7301" x2="535.9409" y1="439.58" y2="439.58" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="96.6038" x="268.8105" y="435.3244">11. userinfo (PSC)</text><polygon fill="#181818" points="66.3626,460.6924,57.9623,464.0525,66.3626,467.4126,63.0025,464.0525" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="61.3224" x2="245.2896" y1="464.0525" y2="464.0525" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="112.5644" x="71.4028" y="459.797">12. OK/KO + userinfo</text><path d="M8.4003,482.5332 L137.7654,482.5332 L137.7654,488.525 L129.3651,496.9253 L8.4003,496.9253 L8.4003,482.5332 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.2600492206726825;" /><rect fill="none" height="197.3486" style="stroke:#000000;stroke-width:1.2600492206726825;" width="966.0377" x="8.4003" y="482.5332" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" font-weight="bold" lengthAdjust="spacing" textLength="91.5636" x="21.0008" y="493.5098">OAUTH2.0 flow</text><polygon fill="#181818" points="236.0492,511.3175,244.4495,514.6776,236.0492,518.0377,239.4094,514.6776" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="57.1222" x2="241.0894" y1="514.6776" y2="514.6776" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="168.8466" x="63.0025" y="510.4221">13 . acces API + jeton applicatif</text><polygon fill="#181818" points="723.2683,535.79,731.6686,539.1501,723.2683,542.5103,726.6284,539.1501" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="250.3298" x2="728.3084" y1="539.1501" y2="539.1501" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="422.5365" x="256.21" y="534.8946">14. subject_token(parametre) + actor_token (parametre) + scope(parametre)</text><polygon fill="#181818" points="550.2215,560.2625,541.8212,563.6226,550.2215,566.9828,546.8614,563.6226" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="545.1813" x2="732.5086" y1="563.6226" y2="563.6226" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="176.4069" x="555.2617" y="559.3671">15. subject_token (introspection)</text><polygon fill="#181818" points="723.2683,584.735,731.6686,588.0952,723.2683,591.4553,726.6284,588.0952" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="536.781" x2="728.3084" y1="588.0952" y2="588.0952" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="15.1206" x="542.6612" y="583.8396">OK</text><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="741.749" x2="777.0304" y1="612.5677" y2="612.5677" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="777.0304" x2="777.0304" y1="612.5677" y2="623.4881" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="742.589" x2="777.0304" y1="623.4881" y2="623.4881" /><polygon fill="#181818" points="750.9893,620.128,742.589,623.4881,750.9893,626.8482,747.6292,623.4881" style="stroke:#181818;stroke-width:0.8400328137817884;" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="216.7285" x="747.6292" y="608.3121">Controle d'acces (Client ID_AS x scopes)</text><polygon fill="#181818" points="263.7703,644.6005,255.37,647.9606,263.7703,651.3208,260.4102,647.9606" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="258.7301" x2="732.5086" y1="647.9606" y2="647.9606" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="93.2436" x="268.8105" y="643.7051">16. access_token</text><polygon fill="#181818" points="964.3577,700.1542,972.758,703.5144,964.3577,706.8745,967.7178,703.5144" style="stroke:#181818;stroke-width:0.8400328137817884;" /><line style="stroke:#181818;stroke-width:0.8400328137817884;" x1="250.3298" x2="969.3979" y1="703.5144" y2="703.5144" /><text fill="#000000" font-family="sans-serif" font-size="10.9204" lengthAdjust="spacing" textLength="212.5283" x="256.21" y="699.2588">17. access_token + acces aux donnees</text></g></svg></div>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="api_prosanteconnectee_userinfo.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="glossaire.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2020+ <a style="color:var(--footer-hyperlink-text-color)" href="https://esante.gouv.fr">ANS</a>.  Package ans.fr.securisation-transport#1.1.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Nov 22, 2023 15:40+0000">2023-11-22</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)"></span>
                      Liens: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table des matières </a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA </a> |
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://interop.esante.gouv.fr/ig/securisation-transport/history.html">Historique des versions </a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/ansforge/FIG_ans-ig-sample/issues/new">New Issue</a>
                

          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>

  <!-- Ajout ANS -->
  <script src="assets/js/app.js" type="text/javascript"> </script>
  <script src="assets/js/vendor.js" type="text/javascript"> </script>
  <!-- Fin ajout ANS -->

  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->


  
    
  



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->


  <!-- AJOUT ANS -->

<footer class="footer footer-principal" role="contentinfo">
  <div class="footer__region1">
    <div class="container">
      <div class="row">

        <div class="col-md-6 col-lg-4 text-center text-md-left">
          <div class="logos">        
            <div class="logo logo--0">
              <a href="https://solidarites-sante.gouv.fr" title="Ministère des Solidarités et de la Santé (nouvelle fenêtre)" target="_blank" rel="nofollow">
                
                <img src="assets/images/logo-ministere.svg" alt="Ministère des Solidarités et de la Santé" width="133" height="77" loading="lazy" />
                
              </a>
            </div>
        
            <div class="logo logo--1">
              <a href="https://esante.gouv.fr/" title="Agence du numérique en santé (nouvelle fenêtre)" target="_blank" rel="nofollow">
                
                <img src="assets/images/logo-ANS-footer.svg" alt="Agence du numérique en santé" width="106" height="74" loading="lazy" />
              </a>
            </div>
          </div>
        </div>
        
        <div class="col-md-6 col-lg-4 text-center text-md-left">
          <p class="footer__title">Agence du Numérique en Santé</p>
          <p>2-10 Rue d'Oradour-sur-Glane 75015 Paris</p>

          <!-- <div class="m-social">
            <ul class="m-social__list">        
              <li class="m-social__item">
                <a class="m-social__link" href="https://www.linkedin.com/company/agence-du-numerique-en-sante/" target="_blank" rel="nofollow">
                  <div class="m-social__icon">
                    <svg class="svg-icon svg-linkedin" aria-hidden="true" focusable="false"><use href="assets/images/icon-sprite.svg#linkedin"></use></svg>
                  </div>
                  <span class="sr-only">linkedin</span>
                </a>
              </li>
              <li class="m-social__item">
                <a class="m-social__link" href="https://twitter.com/esante_gouv_fr" target="_blank" rel="nofollow">
                  <div class="m-social__icon">
                    <svg class="svg-icon svg-twitter" aria-hidden="true" focusable="false"><use href="assets/images/icon-sprite.svg#twitter"></use></svg>
                  </div>
                  <span class="sr-only">twitter</span>
                </a>
              </li>
              <li class="m-social__item">
                <a class="m-social__link" href="https://www.youtube.com/channel/UCd1zuSaU5cE1lRCpwv_HSMA" target="_blank" rel="nofollow">
                  <div class="m-social__icon">
                    <svg class="svg-icon svg-youtube" aria-hidden="true" focusable="false"><use href="assets/images/icon-sprite.svg#youtube"></use></svg>
                  </div>
                  <span class="sr-only">youtube</span>
                </a>
              </li>
              <li class="m-social__item">
                <a class="m-social__link" href="https://esante.gouv.fr/rss.xml" target="_blank" rel="nofollow">
                  <div class="m-social__icon">
                    <svg class="svg-icon svg-rss" aria-hidden="true" focusable="false"><use href="assets/images/icon-sprite.svg#rss"></use></svg>
                  </div>
                  <span class="sr-only">rss</span>
                </a>
              </li>
            </ul>
          </div> -->
        </div>
        
        <div class="col-6 col-lg-4">
          <ul class="footer-list">
            <li class="footer-list__item footer-list__item--hasIcon">
              <a href="mailto:ci-sis@esante.gouv.fr" class="mailto-link">
                <svg class="svg-icon svg-angle-right" aria-hidden="true" focusable="false"><use href="assets/images/icon-sprite.svg#angle-right"></use></svg>Contact</a>
              </li>
              <!-- <li class="footer-list__item">
                <a href="https://interop-pprod.esante.gouv.fr/ci-sis-specifications/wp-content/uploads/CGU_espace_de_tests_v1.1.pdf" class="file-link">Mentions légales</a>
              </li>
               -->
            </ul>
          </div>

        </div>
      </div>
    </div>
    
    <!-- <div class="footer__region2">
      <div class="container">
        <div class="footer-contentinfo">
          <ul class="footer-list footer-list--inline">

          </ul>
        </div>
      </div>
    </div> -->
  </footer>
  </body>
</html>

